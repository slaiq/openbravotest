<?xml version="1.0"?>
  <database name="VIEW ESCM_TRANSACTION_REG_V">
    <view name="ESCM_TRANSACTION_REG_V"><![CDATA[SELECT get_uuid() AS escm_transaction_reg_v_id, main.org, main.pcname, main.characteristic_desc, main.itemcode, main.itemname, main.uomname, main.transactiontype, main.transactionqty, main.stocktype, main.specno, main.docno, main.docdate, main.supplier, main.balance, main.unitprice, main.attributeset, main.description, main.warehouse, main.ad_client_id, main.ad_org_id, main.isactive, main.created, main.createdby, main.updated, main.updatedby FROM (SELECT org.name AS org, (pc.name || '-') || pc.value AS pcname, prd.characteristic_desc, prd.value AS itemcode, prd.name AS itemname, uom.name AS uomname, "inout".trtype AS transactiontype, tr.movementqty AS transactionqty, CASE WHEN prd.em_escm_stock_type = 'CUS' THEN 'Custody' WHEN prd.em_escm_stock_type = 'CON' THEN 'Consumable' ELSE '' END AS stocktype, "inout".specno, "inout".docno, "inout".docdate, "inout".supplier, tr.em_escm_currentonhand AS balance, "inout".unitprice, st.description AS attributeset, prd.description, warehouse.name AS warehouse, tr.ad_client_id, tr.ad_org_id, tr.isactive, tr.created, tr.createdby, tr.updated, tr.updatedby FROM m_transaction tr LEFT JOIN m_product prd ON prd.m_product_id = tr.m_product_id LEFT JOIN m_product_category pc ON pc.m_product_category_id = prd.m_product_category_id LEFT JOIN ad_org org ON org.ad_org_id = tr.ad_org_id LEFT JOIN (SELECT wh.name, loc.m_locator_id FROM m_locator loc JOIN m_warehouse wh ON wh.m_warehouse_id = loc.m_warehouse_id) warehouse ON warehouse.m_locator_id = tr.m_locator_id LEFT JOIN c_uom uom ON uom.c_uom_id = prd.c_uom_id LEFT JOIN (SELECT ot.documentno AS specno, CASE WHEN ot.em_escm_receivingtype = 'DEL' THEN ot.poreference ELSE '' END AS docno, CASE WHEN ot.em_escm_receivingtype = 'DEL' THEN ot.dateacct ELSE NULL END AS docdate, olin.m_inoutline_id, ot.m_inout_id, ref.name AS trtype, bp.name AS supplier, olin.em_escm_unitprice AS unitprice FROM m_inoutline olin LEFT JOIN m_inout ot ON ot.m_inout_id = olin.m_inout_id LEFT JOIN c_bpartner bp ON ot.c_bpartner_id = bp.c_bpartner_id LEFT JOIN ad_ref_list ref ON ref.value = ot.em_escm_receivingtype AND ref.ad_reference_id = '001853451717483682B375C6C6C8EF2B') "inout" ON tr.m_inoutline_id = "inout".m_inoutline_id LEFT JOIN m_attributesetinstance st ON tr.m_attributesetinstance_id = st.m_attributesetinstance_id WHERE tr.em_escm_material_reqln_id IS NULL UNION ALL SELECT org.name AS org, (pc.name || '-') || pc.value AS pcname, prd.characteristic_desc, prd.value AS itemcode, prd.name AS itemname, uom.name AS uomname, 'Material Issue request' AS transactiontype, tr.movementqty AS transactionqty, CASE WHEN prd.em_escm_stock_type = 'CUS' THEN 'Custody' WHEN prd.em_escm_stock_type = 'CON' THEN 'Consumable' ELSE '' END AS stocktype, mir.documentno AS specno, '' AS docno, NULL AS docdate, '' AS supplier, tr.em_escm_currentonhand AS balance, mir.unitprice, st.description AS attributeset, prd.description, warehouse.name AS warehouse, tr.ad_client_id, tr.ad_org_id, tr.isactive, tr.created, tr.createdby, tr.updated, tr.updatedby FROM m_transaction tr LEFT JOIN m_product prd ON prd.m_product_id = tr.m_product_id LEFT JOIN m_product_category pc ON pc.m_product_category_id = prd.m_product_category_id LEFT JOIN c_uom uom ON uom.c_uom_id = prd.c_uom_id LEFT JOIN ad_org org ON org.ad_org_id = tr.ad_org_id LEFT JOIN (SELECT wh.name, loc.m_locator_id FROM m_locator loc JOIN m_warehouse wh ON wh.m_warehouse_id = loc.m_warehouse_id) warehouse ON warehouse.m_locator_id = tr.m_locator_id JOIN (SELECT req.documentno, reqln.escm_material_reqln_id, reqln.unitprice FROM escm_material_reqln reqln JOIN escm_material_request req ON req.escm_material_request_id = reqln.escm_material_request_id) mir ON mir.escm_material_reqln_id = tr.em_escm_material_reqln_id LEFT JOIN m_attributesetinstance st ON tr.m_attributesetinstance_id = st.m_attributesetinstance_id WHERE tr.em_escm_material_reqln_id IS NOT NULL) main]]></view>
  </database>
