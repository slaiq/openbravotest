(function(b){b.jgrid.extend({jqGridImport:function(a){a=b.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},a||{});return this.each(function(){var g=this;var i=function(p,c){var q=b(c.xmlGrid.config,p)[0];
var d=b(c.xmlGrid.data,p)[0],r,f;if(xmlJsonClass.xml2json&&b.jgrid.parse){r=xmlJsonClass.xml2json(q," ");r=b.jgrid.parse(r);for(var o in r){if(r.hasOwnProperty(o)){f=r[o];}}if(d){var e=r.grid.datatype;r.grid.datatype="xmlstring";r.grid.datastr=p;b(g).jqGrid(f).jqGrid("setGridParam",{datatype:e});}else{b(g).jqGrid(f);
}r=null;f=null;}else{alert("xml2json or parse are not present");}};var h=function(m,d){if(m&&typeof m=="string"){var n=b.jgrid.parse(m);var c=n[d.jsonGrid.config];var f=n[d.jsonGrid.data];if(f){var e=c.datatype;c.datatype="jsonstring";c.datastr=f;b(g).jqGrid(c).jqGrid("setGridParam",{datatype:e});}else{b(g).jqGrid(c);
}}};switch(a.imptype){case"xml":b.ajax(b.extend({url:a.impurl,type:a.mtype,data:a.impData,dataType:"xml",complete:function(d,c){if(c=="success"){i(d.responseXML,a);if(b.isFunction(a.importComplete)){a.importComplete(d);}}d=null;}},a.ajaxOptions));break;case"xmlstring":if(a.impstring&&typeof a.impstring=="string"){var j=b.jgrid.stringToDoc(a.impstring);
if(j){i(j,a);if(b.isFunction(a.importComplete)){a.importComplete(j);}a.impstring=null;}j=null;}break;case"json":b.ajax(b.extend({url:a.impurl,type:a.mtype,data:a.impData,dataType:"json",complete:function(d,c){if(c=="success"){h(d.responseText,a);if(b.isFunction(a.importComplete)){a.importComplete(d);
}}d=null;}},a.ajaxOptions));break;case"jsonstring":if(a.impstring&&typeof a.impstring=="string"){h(a.impstring,a);if(b.isFunction(a.importComplete)){a.importComplete(a.impstring);}a.impstring=null;}break;}});},jqGridExport:function(d){d=b.extend({exptype:"xmlstring",root:"grid",ident:"\t"},d||{});var a=null;
this.each(function(){if(!this.grid){return;}var c=b.extend({},b(this).jqGrid("getGridParam"));if(c.rownumbers){c.colNames.splice(0,1);c.colModel.splice(0,1);}if(c.multiselect){c.colNames.splice(0,1);c.colModel.splice(0,1);}if(c.subGrid){c.colNames.splice(0,1);c.colModel.splice(0,1);}c.knv=null;if(c.treeGrid){for(var f in c.treeReader){if(c.treeReader.hasOwnProperty(f)){c.colNames.splice(c.colNames.length-1);
c.colModel.splice(c.colModel.length-1);}}}switch(d.exptype){case"xmlstring":a="<"+d.root+">"+xmlJsonClass.json2xml(c,d.ident)+"</"+d.root+">";break;case"jsonstring":a="{"+xmlJsonClass.toJson(c,d.root,d.ident)+"}";if(c.postData.filters!==undefined){a=a.replace(/filters":"/,'filters":');a=a.replace(/}]}"/,"}]}");
}break;}});return a;},excelExport:function(a){a=b.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},a||{});return this.each(function(){if(!this.grid){return;}var h;if(a.exptype=="remote"){var g=b.extend({},this.p.postData);g[a.oper]=a.tag;var f=jQuery.param(g);if(a.url.indexOf("?")!=-1){h=a.url+"&"+f;
}else{h=a.url+"?"+f;}window.location=h;}});}});})(jQuery);