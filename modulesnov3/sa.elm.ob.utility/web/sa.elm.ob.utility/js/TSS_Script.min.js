function GetBrowserType(){try{var n=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t=typeof InstallTrigger!="undefined",i=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,r=!!window.chrome&&!n,u=!1||!!document.documentMode;return browser=n?"opera":t?"firefox":i?"safari":r?"chrome":u?"ie":"unknown"}catch(f){alert("GetBrowserType Exception ===> "+f.message)}}function SendRequest(){var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)});$.ajax({url:"http://127.0.0.1:37151/",type:"POST",crossdomain:!0,contentType:"application/json; charset=utf-8",dataType:"jsonp",data:{token:n}})}function FireFoxPlugin(n){try{var t=$("#frame1")[0];return $("#frame1").attr("src","about:blank"),t.contentWindow.location.href=n,!0}catch(i){if(i.name=="NS_ERROR_UNKNOWN_PROTOCOL")return!1}}function CallPlugin(n){var t,i;n="tsspdf://"+n;t=GetBrowserType();switch(t){case"chrome":case"opera":case"ie":location.href=n;break;case"safari":case"firefox":i=FireFoxPlugin(n)}myTimer=setInterval(function(){SendRequest()},1e3)}function EndAction(){try{clearInterval(myTimer)}catch(n){}}var browser,myTimer;