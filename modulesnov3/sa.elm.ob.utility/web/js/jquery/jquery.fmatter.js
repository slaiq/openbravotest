(function(b){b.fmatter={};b.extend(b.fmatter,{isBoolean:function(a){return typeof a==="boolean";},isObject:function(a){return(a&&(typeof a==="object"||b.isFunction(a)))||false;},isString:function(a){return typeof a==="string";},isNumber:function(a){return typeof a==="number"&&isFinite(a);},isNull:function(a){return a===null;
},isUndefined:function(a){return typeof a==="undefined";},isValue:function(a){return(this.isObject(a)||this.isString(a)||this.isNumber(a)||this.isBoolean(a));},isEmpty:function(a){if(!this.isString(a)&&this.isValue(a)){return false;}else{if(!this.isValue(a)){return true;}}a=b.trim(a).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");
return a==="";}});b.fn.fmatter=function(i,h,j,a,l){var k=h;j=b.extend({},b.jgrid.formatter,j);if(b.fn.fmatter[i]){k=b.fn.fmatter[i](h,j,a,l);}return k;};b.fmatter.util={NumberFormat:function(v,x){if(!b.fmatter.isNumber(v)){v*=1;}if(b.fmatter.isNumber(v)){var t=(v<0);var o=v+"";var r=(x.decimalSeparator)?x.decimalSeparator:".";
var q;if(b.fmatter.isNumber(x.decimalPlaces)){var p=x.decimalPlaces;var u=Math.pow(10,p);o=Math.round(v*u)/u+"";q=o.lastIndexOf(".");if(p>0){if(q<0){o+=r;q=o.length-1;}else{if(r!=="."){o=o.replace(".",r);}}while((o.length-1-q)<p){o+="0";}}}if(x.thousandsSeparator){var a=x.thousandsSeparator;q=o.lastIndexOf(r);
q=(q>-1)?q:o.length;var i=o.substring(q);var w=-1;for(var s=q;s>0;s--){w++;if((w%3===0)&&(s!==q)&&(!t||(s>1))){i=a+i;}i=o.charAt(s-1)+i;}o=i;}o=(x.prefix)?x.prefix+o:o;o=(x.suffix)?o+x.suffix:o;return o;}else{return v;}},DateFormat:function(o,j,a,s){var Z=/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,S=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,k=/[^-+\dA-Z]/g,Y=new RegExp("^/Date((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?)/$"),ad=j.match(Y),n=function(c,d){c=String(c);
d=parseInt(d,10)||2;while(c.length<d){c="0"+c;}return c;},ah={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},ae=0,U,N,af,R=["i18n"];R.i18n={dayNames:s.dayNames,monthNames:s.monthNames};if(o in s.masks){o=s.masks[o];}if(j.constructor===Number){ae=new Date(j);}else{if(j.constructor===Date){ae=j;}else{if(ad!==null){ae=new Date(parseInt(ad[1],10));
if(ad[3]){var ac=Number(ad[5])*60+Number(ad[6]);ac*=((ad[4]=="-")?1:-1);ac-=ae.getTimezoneOffset();ae.setTime(Number(Number(ae)+(ac*60*1000)));}}else{j=j.split(/[\\\/:_;.,\t\T\s-]/);o=o.split(/[\\\/:_;.,\t\T\s-]/);for(N=0,af=o.length;N<af;N++){if(o[N]=="M"){U=b.inArray(j[N],R.i18n.monthNames);if(U!==-1&&U<12){j[N]=U+1;
}}if(o[N]=="F"){U=b.inArray(j[N],R.i18n.monthNames);if(U!==-1&&U>11){j[N]=U+1-12;}}if(j[N]){ah[o[N].toLowerCase()]=parseInt(j[N],10);}}if(ah.f){ah.m=ah.f;}if(ah.m===0&&ah.y===0&&ah.d===0){return"&#160;";}ah.m=parseInt(ah.m,10)-1;var i=ah.y;if(i>=70&&i<=99){ah.y=1900+ah.y;}else{if(i>=0&&i<=69){ah.y=2000+ah.y;
}}ae=new Date(ah.y,ah.m,ah.d,ah.h,ah.i,ah.s,ah.u);}}}if(a in s.masks){a=s.masks[a];}else{if(!a){a="Y-m-d";}}var G=ae.getHours(),w=ae.getMinutes(),z=ae.getDate(),T=ae.getMonth()+1,W=ae.getTimezoneOffset(),X=ae.getSeconds(),u=ae.getMilliseconds(),Q=ae.getDay(),ag=ae.getFullYear(),aa=(Q+6)%7+1,V=(new Date(ag,T-1,z)-new Date(ag,0,1))/86400000,ab={d:n(z),D:R.i18n.dayNames[Q],j:z,l:R.i18n.dayNames[Q+7],N:aa,S:s.S(z),w:Q,z:V,W:aa<5?Math.floor((V+aa-1)/7)+1:Math.floor((V+aa-1)/7)||((new Date(ag-1,0,1).getDay()+6)%7<4?53:52),F:R.i18n.monthNames[T-1+12],m:n(T),M:R.i18n.monthNames[T-1],n:T,t:"?",L:"?",o:"?",Y:ag,y:String(ag).substring(2),a:G<12?s.AmPm[0]:s.AmPm[1],A:G<12?s.AmPm[2]:s.AmPm[3],B:"?",g:G%12||12,G:G,h:n(G%12||12),H:n(G),i:n(w),s:n(X),u:u,e:"?",I:"?",O:(W>0?"-":"+")+n(Math.floor(Math.abs(W)/60)*100+Math.abs(W)%60,4),P:"?",T:(String(ae).match(S)||[""]).pop().replace(k,""),Z:"?",c:"?",r:"?",U:Math.floor(ae/1000)};
return a.replace(Z,function(c){return c in ab?ab[c]:c.substring(1);});}};b.fn.fmatter.defaultFormat=function(d,a){return(b.fmatter.isValue(d)&&d!=="")?d:a.defaultValue?a.defaultValue:"&#160;";};b.fn.fmatter.email=function(d,a){if(!b.fmatter.isEmpty(d)){return'<a href="mailto:'+d+'">'+d+"</a>";}else{return b.fn.fmatter.defaultFormat(d,a);
}};b.fn.fmatter.checkbox=function(h,j){var g=b.extend({},j.checkbox),i;if(!b.fmatter.isUndefined(j.colModel.formatoptions)){g=b.extend({},g,j.colModel.formatoptions);}if(g.disabled===true){i='disabled="disabled"';}else{i="";}if(b.fmatter.isEmpty(h)||b.fmatter.isUndefined(h)){h=b.fn.fmatter.defaultFormat(h,g);
}h=h+"";h=h.toLowerCase();var a=h.search(/(false|0|no|off)/i)<0?" checked='checked' ":"";return'<input type="checkbox" '+a+' value="'+h+'" offval="no" '+i+"/>";};b.fn.fmatter.link=function(g,a){var f={target:a.target};var h="";if(!b.fmatter.isUndefined(a.colModel.formatoptions)){f=b.extend({},f,a.colModel.formatoptions);
}if(f.target){h="target="+f.target;}if(!b.fmatter.isEmpty(g)){return"<a "+h+' href="'+g+'">'+g+"</a>";}else{return b.fn.fmatter.defaultFormat(g,a);}};b.fn.fmatter.showlink=function(i,a){var g={baseLinkUrl:a.baseLinkUrl,showAction:a.showAction,addParam:a.addParam||"",target:a.target,idName:a.idName},j="",h;
if(!b.fmatter.isUndefined(a.colModel.formatoptions)){g=b.extend({},g,a.colModel.formatoptions);}if(g.target){j="target="+g.target;}h=g.baseLinkUrl+g.showAction+"?"+g.idName+"="+a.rowId+g.addParam;if(b.fmatter.isString(i)||b.fmatter.isNumber(i)){return"<a "+j+' href="'+h+'">'+i+"</a>";}else{return b.fn.fmatter.defaultFormat(i,a);
}};b.fn.fmatter.integer=function(f,a){var e=b.extend({},a.integer);if(!b.fmatter.isUndefined(a.colModel.formatoptions)){e=b.extend({},e,a.colModel.formatoptions);}if(b.fmatter.isEmpty(f)){return e.defaultValue;}return b.fmatter.util.NumberFormat(f,e);};b.fn.fmatter.number=function(f,a){var e=b.extend({},a.number);
if(!b.fmatter.isUndefined(a.colModel.formatoptions)){e=b.extend({},e,a.colModel.formatoptions);}if(b.fmatter.isEmpty(f)){return e.defaultValue;}return b.fmatter.util.NumberFormat(f,e);};b.fn.fmatter.currency=function(f,a){var e=b.extend({},a.currency);if(!b.fmatter.isUndefined(a.colModel.formatoptions)){e=b.extend({},e,a.colModel.formatoptions);
}if(b.fmatter.isEmpty(f)){return e.defaultValue;}return b.fmatter.util.NumberFormat(f,e);};b.fn.fmatter.date=function(h,i,a,j){var g=b.extend({},i.date);if(!b.fmatter.isUndefined(i.colModel.formatoptions)){g=b.extend({},g,i.colModel.formatoptions);}if(!g.reformatAfterEdit&&j=="edit"){return b.fn.fmatter.defaultFormat(h,i);
}else{if(!b.fmatter.isEmpty(h)){return b.fmatter.util.DateFormat(g.srcformat,h,g.newformat,g);}else{return b.fn.fmatter.defaultFormat(h,i);}}};b.fn.fmatter.select=function(s,x,w,p){s=s+"";var u=false,q=[];if(!b.fmatter.isUndefined(x.colModel.formatoptions)){u=x.colModel.formatoptions.value;}else{if(!b.fmatter.isUndefined(x.colModel.editoptions)){u=x.colModel.editoptions.value;
}}if(u){var a=x.colModel.editoptions.multiple===true?true:false,i=[],j;if(a){i=s.split(",");i=b.map(i,function(c){return b.trim(c);});}if(b.fmatter.isString(u)){var v=u.split(";"),t=0;for(var r=0;r<v.length;r++){j=v[r].split(":");if(j.length>2){j[1]=jQuery.map(j,function(d,c){if(c>0){return d;}}).join(":");
}if(a){if(jQuery.inArray(j[0],i)>-1){q[t]=j[1];t++;}}else{if(b.trim(j[0])==b.trim(s)){q[0]=j[1];break;}}}}else{if(b.fmatter.isObject(u)){if(a){q=jQuery.map(i,function(d,c){return u[d];});}else{q[0]=u[s]||"";}}}}s=q.join(", ");return s===""?b.fn.fmatter.defaultFormat(s,x):s;};b.fn.fmatter.rowactions=function(m,n,p,j){var k={keys:false,editbutton:true,delbutton:true,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{oper:"edit"},url:null,delOptions:{}},a=b("#"+n)[0].p.colModel[j];
if(!b.fmatter.isUndefined(a.formatoptions)){k=b.extend(k,a.formatoptions);}var o=function(c){if(k.afterSave){k.afterSave(c);}b("tr#"+m+" div.ui-inline-edit, "+"tr#"+m+" div.ui-inline-del","#"+n).show();b("tr#"+m+" div.ui-inline-save, "+"tr#"+m+" div.ui-inline-cancel","#"+n).hide();},l=function(c){if(k.afterRestore){k.afterRestore(c);
}b("tr#"+m+" div.ui-inline-edit, "+"tr#"+m+" div.ui-inline-del","#"+n).show();b("tr#"+m+" div.ui-inline-save, "+"tr#"+m+" div.ui-inline-cancel","#"+n).hide();};switch(p){case"edit":b("#"+n).jqGrid("editRow",m,k.keys,k.onEdit,k.onSuccess,k.url,k.extraparam,o,k.onError,l);b("tr#"+m+" div.ui-inline-edit, "+"tr#"+m+" div.ui-inline-del","#"+n).hide();
b("tr#"+m+" div.ui-inline-save, "+"tr#"+m+" div.ui-inline-cancel","#"+n).show();break;case"save":b("#"+n).jqGrid("saveRow",m,k.onSuccess,k.url,k.extraparam,o,k.onError,l);b("tr#"+m+" div.ui-inline-edit, "+"tr#"+m+" div.ui-inline-del","#"+n).show();b("tr#"+m+" div.ui-inline-save, "+"tr#"+m+" div.ui-inline-cancel","#"+n).hide();
break;case"cancel":b("#"+n).jqGrid("restoreRow",m,l);b("tr#"+m+" div.ui-inline-edit, "+"tr#"+m+" div.ui-inline-del","#"+n).show();b("tr#"+m+" div.ui-inline-save, "+"tr#"+m+" div.ui-inline-cancel","#"+n).hide();break;case"del":b("#"+n).jqGrid("delGridRow",m,k.delOptions);break;}};b.fn.fmatter.actions=function(k,m,a){var i={keys:false,editbutton:true,delbutton:true};
if(!b.fmatter.isUndefined(m.colModel.formatoptions)){i=b.extend(i,m.colModel.formatoptions);}var n=m.rowId,j="",l;if(typeof(n)=="undefined"||b.fmatter.isEmpty(n)){return"";}if(i.editbutton){l="onclick=$.fn.fmatter.rowactions('"+n+"','"+m.gid+"','edit',"+m.pos+");";j=j+"<div style='margin-left:8px;'><div title='"+b.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+l+"><span class='ui-icon ui-icon-pencil'></span></div>";
}if(i.delbutton){l="onclick=$.fn.fmatter.rowactions('"+n+"','"+m.gid+"','del',"+m.pos+");";j=j+"<div title='"+b.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+l+"><span class='ui-icon ui-icon-trash'></span></div>";}l="onclick=$.fn.fmatter.rowactions('"+n+"','"+m.gid+"','save',"+m.pos+");";
j=j+"<div title='"+b.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save'><span class='ui-icon ui-icon-disk' "+l+"></span></div>";l="onclick=$.fn.fmatter.rowactions('"+n+"','"+m.gid+"','cancel',"+m.pos+");";j=j+"<div title='"+b.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel'><span class='ui-icon ui-icon-cancel' "+l+"></span></div></div>";
return j;};b.unformat=function(w,o,r,y){var t,v=o.colModel.formatter,u=o.colModel.formatoptions||{},a,p=/([\.\*\_\'\(\)\{\}\+\?\\])/g,s=o.colModel.unformat||(b.fn.fmatter[v]&&b.fn.fmatter[v].unformat);if(typeof s!=="undefined"&&b.isFunction(s)){t=s(b(w).text(),o,w);}else{if(!b.fmatter.isUndefined(v)&&b.fmatter.isString(v)){var z=b.jgrid.formatter||{},q;
switch(v){case"integer":u=b.extend({},z.integer,u);a=u.thousandsSeparator.replace(p,"\\$1");q=new RegExp(a,"g");t=b(w).text().replace(q,"");break;case"number":u=b.extend({},z.number,u);a=u.thousandsSeparator.replace(p,"\\$1");q=new RegExp(a,"g");t=b(w).text().replace(q,"").replace(u.decimalSeparator,".");
break;case"currency":u=b.extend({},z.currency,u);a=u.thousandsSeparator.replace(p,"\\$1");q=new RegExp(a,"g");t=b(w).text().replace(q,"").replace(u.decimalSeparator,".").replace(u.prefix,"").replace(u.suffix,"");break;case"checkbox":var x=(o.colModel.editoptions)?o.colModel.editoptions.value.split(":"):["Yes","No"];
t=b("input",w).attr("checked")?x[0]:x[1];break;case"select":t=b.unformat.select(w,o,r,y);break;case"actions":return"";default:t=b(w).text();}}}return t?t:y===true?b(w).text():b.jgrid.htmlDecode(b(w).html());};b.unformat.select=function(x,a,t,A){var u=[];var j=b(x).text();if(A===true){return j;}var v=b.extend({},a.colModel.editoptions);
if(v.value){var z=v.value,i=v.multiple===true?true:false,r=[],s;if(i){r=j.split(",");r=b.map(r,function(c){return b.trim(c);});}if(b.fmatter.isString(z)){var B=z.split(";"),y=0;for(var w=0;w<B.length;w++){s=B[w].split(":");if(s.length>2){s[1]=jQuery.map(s,function(d,c){if(c>0){return d;}}).join(":");
}if(i){if(jQuery.inArray(s[1],r)>-1){u[y]=s[0];y++;}}else{if(b.trim(s[1])==b.trim(j)){u[0]=s[0];break;}}}}else{if(b.fmatter.isObject(z)||b.isArray(z)){if(!i){r[0]=j;}u=jQuery.map(r,function(c){var d;b.each(z,function(f,e){if(e==c){d=f;return false;}});if(typeof(d)!="undefined"){return d;}});}}return u.join(", ");
}else{return j||"";}};b.unformat.date=function(f,a){var e=b.jgrid.formatter.date||{};if(!b.fmatter.isUndefined(a.formatoptions)){e=b.extend({},e,a.formatoptions);}if(!b.fmatter.isEmpty(f)){return b.fmatter.util.DateFormat(e.newformat,f,e.srcformat,e);}else{return b.fn.fmatter.defaultFormat(f,a);}};})(jQuery);
