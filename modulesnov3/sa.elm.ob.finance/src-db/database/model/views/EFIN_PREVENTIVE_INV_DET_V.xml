<?xml version="1.0"?>
  <database name="VIEW EFIN_PREVENTIVE_INV_DET_V">
    <view name="EFIN_PREVENTIVE_INV_DET_V"><![CDATA[SELECT co.documentno AS po_number, e.value AS account, e.name AS account_name, CASE WHEN co.em_escm_appstatus = 'ESCM_AP' THEN 'Approved' WHEN co.em_escm_appstatus = 'DR' THEN 'Draft' WHEN co.em_escm_appstatus = 'ESCM_OHLD' THEN 'OnHold' WHEN co.em_escm_appstatus = 'ESCM_REJ' THEN 'Rejected' WHEN co.em_escm_appstatus = 'ESCM_IP' THEN 'In Progress' WHEN co.em_escm_appstatus = 'ESCM_RA' THEN 'Require Re-Approval' WHEN co.em_escm_appstatus = 'ESCM_WD' THEN 'Withdraw' WHEN co.em_escm_appstatus = 'ESCM_CA' THEN 'Cancelled' ELSE NULL END AS po_status, co.grandtotal AS po_net_amt, co.em_efin_remaining_amt AS remaining_amt, co.em_efin_legacypaid_amt AS paid_amt, inv.documentno AS invoice_number, trunc(inv.dateinvoiced) AS invoice_date, inv.grandtotal AS inv_gross_total, txn.match_amt, CASE WHEN inv.docstatus = 'CO' THEN 'Completed' WHEN inv.docstatus = 'EFIN_CA' THEN 'Cancelled' WHEN inv.docstatus = 'DR' THEN 'Draft' WHEN inv.docstatus = 'EFIN_WFA' THEN 'Waiting for Approval' ELSE NULL END AS invoice_status, co.em_escm_letter_no AS letter_no, co.em_escm_maintenance_cntrct_no AS main_contract_no FROM c_elementvalue e, c_validcombination c, (SELECT c_orderline.em_efin_c_validcombination_id, c_orderline.c_order_id, sum(c_orderline.em_escm_net_unitprice) AS net_unit_price FROM c_orderline GROUP BY c_orderline.em_efin_c_validcombination_id, c_orderline.c_order_id) coln, (SELECT max(r.em_escm_revision) AS em_escm_revision, r.documentno FROM c_order r GROUP BY r.documentno) co1, c_order co LEFT JOIN c_invoice inv ON co.c_order_id = inv.c_order_id OR co.c_order_id = inv.em_efin_c_order_id LEFT JOIN efin_rdvtxn txn ON txn.c_invoice_id = inv.c_invoice_id WHERE co.em_escm_revision = co1.em_escm_revision AND co.documentno = co1.documentno AND co.c_order_id = coln.c_order_id AND coln.em_efin_c_validcombination_id = c.c_validcombination_id AND c.account_id = e.c_elementvalue_id AND (e.value IN ('302000101', '302000201', '302000301', '302000401', '302000501', '302000601', '302000701', '302000801', '302000901', '302001001', '302001101', '302001201', '302001301', '400230233', '400230325', '400230424', '400230428', '400231010', '407600300')) ORDER BY e.value, co.documentno, inv.documentno]]></view>
  </database>
