<?xml version="1.0"?>
  <database name="VIEW EFIN_CHAPTERWISE_BUD_DETAIL_V">
    <view name="EFIN_CHAPTERWISE_BUD_DETAIL_V"><![CDATA[SELECT get_uuid() AS efin_chapterwise_bud_detail_v_id, a.chapter, a.financial_year, COALESCE(a.original_amount, 0) AS original_amount, COALESCE(a.current_amount, 0) AS current_amount, COALESCE(a.actual) AS actual_amount, COALESCE(a.funds_available, 0) AS funds_available, round(a.actual / a.current_amount * 100, 2) AS invoice_percentage, COALESCE(b.cr_amt_expense, 0) AS cr_amt_expense FROM (SELECT chp.chapter, bint.name AS financial_year, sum(inq.org_amt) AS original_amount, sum(inq.current_budget) AS current_amount, sum(inq.spent_amt) AS actual, sum(inq.funds_available) + sum(inq.encumbrance) AS funds_available FROM efin_budgetinquiry inq JOIN efin_budgetint bint ON bint.efin_budgetint_id = inq.efin_budgetint_id JOIN efin_acct_chapter_report_v chp ON chp.efin_acct_chapter_report_v_id = inq.c_elementvalue_id AND chp.accounttype = 'E' WHERE inq.c_salesregion_id = '38E2AC97B70641F2AF72CBB634935FC4' AND inq.c_campaign_id = '11F9670AC2DC499885BAE97494C595AD' GROUP BY chp.chapter, bint.efin_budgetint_id ORDER BY bint.name, chp.chapter) a LEFT JOIN (SELECT chp.chapter, bint.name AS financial_year, COALESCE(sum(fact.amtacctcr), 0) AS cr_amt_expense FROM gl_journal gl JOIN fact_acct fact ON fact.record_id = gl.gl_journal_id AND fact.ad_table_id = '224' AND fact.amtacctcr > 0 JOIN efin_acct_chapter_report_v chp ON chp.efin_acct_chapter_report_v_id = fact.account_id AND chp.accounttype = 'E' JOIN efin_budgetint bint ON bint.efin_budgetint_id = gl.em_efin_budgetint_id WHERE gl.posted = 'Y' GROUP BY chp.chapter, bint.efin_budgetint_id) b ON a.chapter = b.chapter AND a.financial_year = b.financial_year ORDER BY a.financial_year, a.chapter]]></view>
  </database>
