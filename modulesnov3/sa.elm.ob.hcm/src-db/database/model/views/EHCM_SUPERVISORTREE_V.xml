<?xml version="1.0"?>
  <database name="VIEW EHCM_SUPERVISORTREE_V">
    <view name="EHCM_SUPERVISORTREE_V"><![CDATA[SELECT a.ehcm_supervisortree_v_id, a.ad_client_id, a.ad_org_id, a.isactive, a.created, a.createdby, a.updated, a.updatedby, a.ehcm_emp_perinfo_id, a.emp_parent_id, a.noofsubordinates, 'Y' AS ishierarchy, a.ehcm_emp_hierarchy_id, a.name FROM (SELECT info.value, info.ehcm_emp_perinfo_id, sup.ad_client_id, sup.ad_org_id, sup.isactive, sup.created, sup.createdby, sup.updated, sup.updatedby, sup.noofsubordinates, NULL AS emp_parent_id, sup.ehcm_emp_hierarchy_id, sup.ehcm_emp_supervisor_id AS ehcm_supervisortree_v_id, (info.value || '-') || info.arabicname AS name FROM ehcm_emp_supervisor sup JOIN ehcm_emp_perinfo info ON info.ehcm_emp_perinfo_id = sup.ehcm_emp_perinfo_id AND NOT (sup.ehcm_emp_perinfo_id IN (SELECT node.ehcm_emp_perinfo_id FROM ehcm_emp_supervisornode node LEFT JOIN ehcm_emp_supervisor super ON node.ehcm_emp_supervisor_id = super.ehcm_emp_supervisor_id WHERE super.ehcm_emp_hierarchy_id = sup.ehcm_emp_hierarchy_id)) UNION SELECT info.value, info.ehcm_emp_perinfo_id, sup.ad_client_id, sup.ad_org_id, sup.isactive, sup.created, sup.createdby, sup.updated, sup.updatedby, node.noofsubordinates, COALESCE((SELECT supnode.ehcm_emp_supervisornode_id FROM ehcm_emp_supervisornode supnode WHERE (supnode.ehcm_emp_supervisor_id IN (SELECT ehcm_emp_supervisor.ehcm_emp_supervisor_id FROM ehcm_emp_supervisor WHERE ehcm_emp_supervisor.ehcm_emp_hierarchy_id = sup.ehcm_emp_hierarchy_id)) AND supnode.ehcm_emp_perinfo_id = sup.ehcm_emp_perinfo_id), sup.ehcm_emp_supervisor_id) AS emp_parent_id, sup.ehcm_emp_hierarchy_id, node.ehcm_emp_supervisornode_id AS ehcm_supervisortree_v_id, (info.value || '-') || info.arabicname AS name FROM ehcm_emp_supervisornode node JOIN ehcm_emp_supervisor sup ON node.ehcm_emp_supervisor_id = sup.ehcm_emp_supervisor_id JOIN ehcm_emp_perinfo info ON info.ehcm_emp_perinfo_id = node.ehcm_emp_perinfo_id AND (sup.ehcm_emp_perinfo_id IN (SELECT super.ehcm_emp_perinfo_id FROM ehcm_emp_supervisor super WHERE super.ehcm_emp_hierarchy_id = sup.ehcm_emp_hierarchy_id))) a]]></view>
  </database>
