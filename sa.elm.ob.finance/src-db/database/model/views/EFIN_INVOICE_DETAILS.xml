<?xml version="1.0"?>
  <database name="VIEW EFIN_INVOICE_DETAILS">
    <view name="EFIN_INVOICE_DETAILS"><![CDATA[SELECT (substr(bt.name, 6) || '/') || substr(bt.name, 1, 4) AS fin_year, inv.documentno, to_char(to_date(eut_convert_to_hijri(to_char(inv.dateinvoiced, 'YYYY-MM-DD'))), 'YYYYMMDD') AS invoice_date, bp.name AS supplier, (SELECT DISTINCT fc.em_efin_acctseq FROM fact_acct fc WHERE fc.em_efin_documentno = inv.documentno) AS account_sequence, CASE WHEN ((SELECT ty.em_efin_isrdvinv FROM c_doctype ty WHERE ty.c_doctype_id = inv.c_doctypetarget_id)) = 'Y' THEN COALESCE(inv.description, ((((((((('  قيمة المستخلص الجاري رقم ' || (((SELECT COALESCE(rdt.certificate_no, to_char(rdt.txn_version)) AS "coalesce" FROM efin_rdvtxn rdt WHERE rdt.c_invoice_id = inv.c_invoice_id LIMIT 1)))) || ' الممثل للأعمال ') || ' المنجزة حتى تاريخ ') || ' ') || ((SELECT (to_char(to_date(eut_convert_to_hijri(to_char(rdt.txnver_date, 'YYYY-MM-DD'))), 'DD/MM/YYYY') || ' الموافق ') || to_char(rdt.txnver_date, 'DD/MM/YYYY') AS version_date_greg FROM efin_rdvtxn rdt WHERE rdt.c_invoice_id = inv.c_invoice_id LIMIT 1))) || ' ') || (((SELECT co.em_escm_notes FROM c_order co WHERE co.c_order_id = inv.c_order_id LIMIT 1)))) || ' برقم تبليغ  ') || (((SELECT to_char(COALESCE(leg.award_no, '')) AS to_char FROM escm_legacy_contract leg, c_order co, c_invoice ci WHERE 1 = 1 AND ci.c_invoice_id = '136361C1120047F582FA03483204D902' AND co.em_escm_legacycontract = leg.escm_legacy_contract_id AND ci.c_order_id = co.c_order_id))))) ELSE inv.description END AS invoice_description, inv.grandtotal AS invoice_amount, org.value AS org_code, org.name AS org_name, cos.name AS department_name, CASE WHEN cos.value = '201900' THEN org.value || '-0204500' WHEN cos.value = '0201200' THEN org.value || '-0201200' WHEN cos.value = '0201220' THEN org.value || '-0201220' WHEN cos.value = '0201210' THEN org.value || '-0201210' WHEN cos.value = '5' THEN org.value || '-0206540' WHEN cos.value = '0202920' THEN org.value || '-0202920' WHEN cos.value = '0207200' THEN org.value || '-0207200' WHEN cos.value = '9' THEN org.value || '-0201660' WHEN cos.value = '0201300' THEN org.value || '-0201300' WHEN cos.value = '11' THEN org.value || '-0200140' WHEN cos.value = '0201230' THEN org.value || '-0201230' WHEN cos.value = '0202910' THEN org.value || '-0202910' WHEN cos.value = '14' THEN org.value || '-0204420' WHEN cos.value = '0202620' THEN org.value || '-0202620' WHEN cos.value = '0201720' THEN org.value || '-0201720' WHEN cos.value = '0202300' THEN org.value || '-0202300' WHEN cos.value = '0200111' THEN org.value || '-0200111' WHEN cos.value = '19' THEN org.value || '-0202800' WHEN cos.value = '0201280' THEN org.value || '-0201280' WHEN cos.value = '0201900' THEN org.value || '-0204500' WHEN cos.value = '0204700' THEN org.value || '-0204700' WHEN cos.value = '0204600' THEN org.value || '-0204600' WHEN cos.value = '0202400' THEN org.value || '-0202400' WHEN cos.value = '0202500' THEN org.value || '-0202500' WHEN cos.value = '0202700' THEN org.value || '-0202700' WHEN cos.value = '0202800' THEN org.value || '-0202800' WHEN cos.value = '28' THEN org.value || '-0204300' WHEN cos.value = '29' THEN org.value || '-0208500' WHEN cos.value = '30' THEN org.value || '-0208500' WHEN cos.value = '0204800' THEN org.value || '-0204800' WHEN cos.value = '0203300' THEN org.value || '-0203300' WHEN cos.value = '0203400' THEN org.value || '-0203400' WHEN cos.value = '0203500' THEN org.value || '-0203500' WHEN cos.value = '0203600' THEN org.value || '-0203600' WHEN cos.value = '36' THEN org.value || '-0201400' WHEN cos.value = '37' THEN org.value || '-0202010' WHEN cos.value = '0203010' THEN org.value || '-0203010' WHEN cos.value = '39' THEN org.value || '-0201240' WHEN cos.value = '40' THEN org.value || '-' WHEN cos.value = '41' THEN org.value || '-0201610' WHEN cos.value = '0203120' THEN org.value || '-0203120' WHEN cos.value = '43' THEN org.value || '-0201800' WHEN cos.value = '0200165' THEN org.value || '-0200165' WHEN cos.value = '0202030' THEN org.value || '-0202030' WHEN cos.value = '46' THEN org.value || '-0200130' WHEN cos.value = '47' THEN org.value || '-0200170' WHEN cos.value = '0203800' THEN org.value || '-0203800' WHEN cos.value = '50' THEN org.value || '-0201010' WHEN cos.value = '0202600' THEN org.value || '-0202600' WHEN cos.value = '100' THEN org.value || '-0200100' WHEN cos.value = '990' THEN org.value || '-' WHEN cos.value = '999' THEN org.value || '-' WHEN cos.value = '1010' THEN org.value || '-0201310' WHEN cos.value = '0201310' THEN org.value || '-0201310' WHEN cos.value = '0201340' THEN org.value || '-0201340' WHEN cos.value = '0201330' THEN org.value || '-0201330' WHEN cos.value = '0207000' THEN org.value || '-0207000' WHEN cos.value = '0204300' THEN org.value || '-0204300' WHEN cos.value = '1017' THEN org.value || '-0201200' WHEN cos.value = '1018' THEN org.value || '-0204900' WHEN cos.value = '0204430' THEN org.value || '-0204430' WHEN cos.value = '1020' THEN org.value || '-0204700' WHEN cos.value = '0201660' THEN org.value || '-0201660' WHEN cos.value = '0209200' THEN org.value || '-0209200' WHEN cos.value = '0202230' THEN org.value || '-0202230' WHEN cos.value = '1024' THEN org.value || '-0202220' WHEN cos.value = '1025' THEN org.value || '-0202040' WHEN cos.value = '1026' THEN org.value || '-0202300' WHEN cos.value = '1027' THEN org.value || '-0205300' WHEN cos.value = '1028' THEN org.value || '-0205100' WHEN cos.value = '0205210' THEN org.value || '-0205210' WHEN cos.value = '1030' THEN org.value || '-0204600' WHEN cos.value = '1031' THEN org.value || '-0202230' WHEN cos.value = '0202700' THEN org.value || '-0202700' WHEN cos.value = '1033' THEN org.value || '-0208000' WHEN cos.value = '0200150' THEN org.value || '-0200150' WHEN cos.value = '1035' THEN org.value || '-0200191' WHEN cos.value = '0201600' THEN org.value || '-0201600' WHEN cos.value = '1037' THEN org.value || '-0207000' WHEN cos.value = '0206001' THEN org.value || '-0206001' WHEN cos.value = '0206002' THEN org.value || '-0206002' WHEN cos.value = '0206003' THEN org.value || '-0206003' WHEN cos.value = '0206004' THEN org.value || '-0206004' WHEN cos.value = '0206005' THEN org.value || '-0206005' WHEN cos.value = '0206006' THEN org.value || '-0206006' WHEN cos.value = '0206007' THEN org.value || '-0206007' WHEN cos.value = '0206008' THEN org.value || '-0206008' WHEN cos.value = '0206009' THEN org.value || '-0206009' WHEN cos.value = '0206010' THEN org.value || '-0206010' WHEN cos.value = '0206011' THEN org.value || '-0206011' WHEN cos.value = '0206012' THEN org.value || '-0206012' WHEN cos.value = '0206013' THEN org.value || '-0206013' WHEN cos.value = '0206401' THEN org.value || '-0206005' ELSE (org.value || '-') || cos.value END AS department_code, bp.em_efin_documentno AS supplier_id, bpg.value AS supplier_category_code, bpg.name AS supplier_category, bpg.name AS supplier_category_desc, usr.phone AS supplier_mobile, inv.em_efin_mumtalakatdesc AS mumtalakatdept FROM c_invoice inv LEFT JOIN efin_budgetint bt ON inv.em_efin_budgetint_id = bt.efin_budgetint_id LEFT JOIN c_bpartner bp ON bp.c_bpartner_id = inv.c_bpartner_id LEFT JOIN ad_user usr ON usr.c_bpartner_id = bp.c_bpartner_id LEFT JOIN c_bp_group bpg ON bpg.c_bp_group_id = bp.c_bp_group_id LEFT JOIN ad_org org ON org.ad_org_id = inv.ad_org_id LEFT JOIN c_salesregion cos ON inv.em_efin_c_salesregion_id = cos.c_salesregion_id WHERE inv.docstatus IN ('EFIN_WFA', 'CO')]]></view>
  </database>
