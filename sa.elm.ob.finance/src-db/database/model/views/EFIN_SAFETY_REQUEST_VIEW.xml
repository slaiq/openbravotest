<?xml version="1.0"?>
  <database name="VIEW EFIN_SAFETY_REQUEST_VIEW">
    <view name="EFIN_SAFETY_REQUEST_VIEW"><![CDATA[SELECT ord.documentno, elem.value, sum(ln.linenetamt * CASE WHEN inv.c_currency_id = '317' THEN 1 ELSE COALESCE((SELECT c_conversion_rate.multiplyrate FROM c_conversion_rate WHERE c_conversion_rate.c_currency_id = inv.c_currency_id), 1) END) AS actualamount, 1 AS month, bint.name AS year,date_part('year'::text, inv.created) as gregorian_year FROM c_order ord LEFT JOIN c_invoice inv ON ord.c_order_id = inv.c_order_id OR ord.c_order_id = inv.em_efin_c_order_id LEFT JOIN c_invoiceline ln ON inv.c_invoice_id = ln.c_invoice_id LEFT JOIN c_validcombination dime ON dime.c_validcombination_id = ln.em_efin_c_validcombination_id LEFT JOIN c_elementvalue elem ON elem.c_elementvalue_id = dime.account_id LEFT JOIN efin_budgetint bint ON inv.em_efin_budgetint_id = bint.efin_budgetint_id WHERE inv.docstatus = 'CO' AND date_part('month', inv.created) = 1::double precision GROUP BY ln.em_efin_c_elementvalue_id, ord.documentno, elem.value, bint.name, inv.created UNION ALL SELECT ord.documentno, elem.value, sum(ln.linenetamt * CASE WHEN inv.c_currency_id = '317' THEN 1 ELSE COALESCE((SELECT c_conversion_rate.multiplyrate FROM c_conversion_rate WHERE c_conversion_rate.c_currency_id = inv.c_currency_id), 1) END) AS actualamount, 2 AS month, bint.name AS year,date_part('year'::text, inv.created) as gregorian_year FROM c_order ord LEFT JOIN c_invoice inv ON ord.c_order_id = inv.c_order_id OR ord.c_order_id = inv.em_efin_c_order_id LEFT JOIN c_invoiceline ln ON inv.c_invoice_id = ln.c_invoice_id LEFT JOIN c_validcombination dime ON dime.c_validcombination_id = ln.em_efin_c_validcombination_id LEFT JOIN c_elementvalue elem ON elem.c_elementvalue_id = dime.account_id LEFT JOIN efin_budgetint bint ON inv.em_efin_budgetint_id = bint.efin_budgetint_id WHERE inv.docstatus = 'CO' AND date_part('month', inv.created) = 2::double precision GROUP BY ln.em_efin_c_elementvalue_id, ord.documentno, elem.value, bint.name, inv.created UNION ALL SELECT ord.documentno, elem.value, sum(ln.linenetamt * CASE WHEN inv.c_currency_id = '317' THEN 1 ELSE COALESCE((SELECT c_conversion_rate.multiplyrate FROM c_conversion_rate WHERE c_conversion_rate.c_currency_id = inv.c_currency_id), 1) END) AS actualamount, 3 AS month, bint.name AS year, date_part('year'::text, inv.created) as gregorian_year FROM c_order ord LEFT JOIN c_invoice inv ON ord.c_order_id = inv.c_order_id OR ord.c_order_id = inv.em_efin_c_order_id LEFT JOIN c_invoiceline ln ON inv.c_invoice_id = ln.c_invoice_id LEFT JOIN c_validcombination dime ON dime.c_validcombination_id = ln.em_efin_c_validcombination_id LEFT JOIN c_elementvalue elem ON elem.c_elementvalue_id = dime.account_id LEFT JOIN efin_budgetint bint ON inv.em_efin_budgetint_id = bint.efin_budgetint_id WHERE inv.docstatus = 'CO' AND date_part('month', inv.created) = 3::double precision GROUP BY ln.em_efin_c_elementvalue_id, ord.documentno, elem.value, bint.name, inv.created UNION ALL SELECT ord.documentno, elem.value, sum(ln.linenetamt * CASE WHEN inv.c_currency_id = '317' THEN 1 ELSE COALESCE((SELECT c_conversion_rate.multiplyrate FROM c_conversion_rate WHERE c_conversion_rate.c_currency_id = inv.c_currency_id), 1) END) AS actualamount, 4 AS month, bint.name AS year, date_part('year'::text, inv.created) as gregorian_year FROM c_order ord LEFT JOIN c_invoice inv ON ord.c_order_id = inv.c_order_id OR ord.c_order_id = inv.em_efin_c_order_id LEFT JOIN c_invoiceline ln ON inv.c_invoice_id = ln.c_invoice_id LEFT JOIN c_validcombination dime ON dime.c_validcombination_id = ln.em_efin_c_validcombination_id LEFT JOIN c_elementvalue elem ON elem.c_elementvalue_id = dime.account_id LEFT JOIN efin_budgetint bint ON inv.em_efin_budgetint_id = bint.efin_budgetint_id WHERE inv.docstatus = 'CO' AND date_part('month', inv.created) = 4::double precision GROUP BY ln.em_efin_c_elementvalue_id, ord.documentno, elem.value, bint.name, inv.created UNION ALL SELECT ord.documentno, elem.value, sum(ln.linenetamt * CASE WHEN inv.c_currency_id = '317' THEN 1 ELSE COALESCE((SELECT c_conversion_rate.multiplyrate FROM c_conversion_rate WHERE c_conversion_rate.c_currency_id = inv.c_currency_id), 1) END) AS actualamount, 5 AS month, bint.name AS year,date_part('year'::text, inv.created) as gregorian_year FROM c_order ord LEFT JOIN c_invoice inv ON ord.c_order_id = inv.c_order_id OR ord.c_order_id = inv.em_efin_c_order_id LEFT JOIN c_invoiceline ln ON inv.c_invoice_id = ln.c_invoice_id LEFT JOIN c_validcombination dime ON dime.c_validcombination_id = ln.em_efin_c_validcombination_id LEFT JOIN c_elementvalue elem ON elem.c_elementvalue_id = dime.account_id LEFT JOIN efin_budgetint bint ON inv.em_efin_budgetint_id = bint.efin_budgetint_id WHERE inv.docstatus = 'CO' AND date_part('month', inv.created) = 5::double precision GROUP BY ln.em_efin_c_elementvalue_id, ord.documentno, elem.value, bint.name,inv.created UNION ALL SELECT ord.documentno, elem.value, sum(ln.linenetamt * CASE WHEN inv.c_currency_id = '317' THEN 1 ELSE COALESCE((SELECT c_conversion_rate.multiplyrate FROM c_conversion_rate WHERE c_conversion_rate.c_currency_id = inv.c_currency_id), 1) END) AS actualamount, 6 AS month, bint.name AS year,date_part('year'::text, inv.created) as gregorian_year FROM c_order ord LEFT JOIN c_invoice inv ON ord.c_order_id = inv.c_order_id OR ord.c_order_id = inv.em_efin_c_order_id LEFT JOIN c_invoiceline ln ON inv.c_invoice_id = ln.c_invoice_id LEFT JOIN c_validcombination dime ON dime.c_validcombination_id = ln.em_efin_c_validcombination_id LEFT JOIN c_elementvalue elem ON elem.c_elementvalue_id = dime.account_id LEFT JOIN efin_budgetint bint ON inv.em_efin_budgetint_id = bint.efin_budgetint_id WHERE inv.docstatus = 'CO' AND date_part('month', inv.created) = 6::double precision GROUP BY ln.em_efin_c_elementvalue_id, ord.documentno, elem.value, bint.name, inv.created UNION ALL SELECT ord.documentno, elem.value, sum(ln.linenetamt * CASE WHEN inv.c_currency_id = '317' THEN 1 ELSE COALESCE((SELECT c_conversion_rate.multiplyrate FROM c_conversion_rate WHERE c_conversion_rate.c_currency_id = inv.c_currency_id), 1) END) AS actualamount, 7 AS month, bint.name AS year,date_part('year'::text, inv.created) as gregorian_year FROM c_order ord LEFT JOIN c_invoice inv ON ord.c_order_id = inv.c_order_id OR ord.c_order_id = inv.em_efin_c_order_id LEFT JOIN c_invoiceline ln ON inv.c_invoice_id = ln.c_invoice_id LEFT JOIN c_validcombination dime ON dime.c_validcombination_id = ln.em_efin_c_validcombination_id LEFT JOIN c_elementvalue elem ON elem.c_elementvalue_id = dime.account_id LEFT JOIN efin_budgetint bint ON inv.em_efin_budgetint_id = bint.efin_budgetint_id WHERE inv.docstatus = 'CO' AND date_part('month', inv.created) = 7::double precision GROUP BY ln.em_efin_c_elementvalue_id, ord.documentno, elem.value, bint.name, inv.created UNION ALL SELECT ord.documentno, elem.value, sum(ln.linenetamt * CASE WHEN inv.c_currency_id = '317' THEN 1 ELSE COALESCE((SELECT c_conversion_rate.multiplyrate FROM c_conversion_rate WHERE c_conversion_rate.c_currency_id = inv.c_currency_id), 1) END) AS actualamount, 8 AS month, bint.name AS year, date_part('year'::text, inv.created) as gregorian_year FROM c_order ord LEFT JOIN c_invoice inv ON ord.c_order_id = inv.c_order_id OR ord.c_order_id = inv.em_efin_c_order_id LEFT JOIN c_invoiceline ln ON inv.c_invoice_id = ln.c_invoice_id LEFT JOIN c_validcombination dime ON dime.c_validcombination_id = ln.em_efin_c_validcombination_id LEFT JOIN c_elementvalue elem ON elem.c_elementvalue_id = dime.account_id LEFT JOIN efin_budgetint bint ON inv.em_efin_budgetint_id = bint.efin_budgetint_id WHERE inv.docstatus = 'CO' AND date_part('month', inv.created) = 8::double precision GROUP BY ln.em_efin_c_elementvalue_id, ord.documentno, elem.value, bint.name, inv.created UNION ALL SELECT ord.documentno, elem.value, sum(ln.linenetamt * CASE WHEN inv.c_currency_id = '317' THEN 1 ELSE COALESCE((SELECT c_conversion_rate.multiplyrate FROM c_conversion_rate WHERE c_conversion_rate.c_currency_id = inv.c_currency_id), 1) END) AS actualamount, 9 AS month, bint.name AS year,date_part('year'::text, inv.created) as gregorian_year FROM c_order ord LEFT JOIN c_invoice inv ON ord.c_order_id = inv.c_order_id OR ord.c_order_id = inv.em_efin_c_order_id LEFT JOIN c_invoiceline ln ON inv.c_invoice_id = ln.c_invoice_id LEFT JOIN c_validcombination dime ON dime.c_validcombination_id = ln.em_efin_c_validcombination_id LEFT JOIN c_elementvalue elem ON elem.c_elementvalue_id = dime.account_id LEFT JOIN efin_budgetint bint ON inv.em_efin_budgetint_id = bint.efin_budgetint_id WHERE inv.docstatus = 'CO' AND date_part('month', inv.created) = 9::double precision GROUP BY ln.em_efin_c_elementvalue_id, ord.documentno, elem.value, bint.name, inv.created UNION ALL SELECT ord.documentno, elem.value, sum(ln.linenetamt * CASE WHEN inv.c_currency_id = '317' THEN 1 ELSE COALESCE((SELECT c_conversion_rate.multiplyrate FROM c_conversion_rate WHERE c_conversion_rate.c_currency_id = inv.c_currency_id), 1) END) AS actualamount, 10 AS month, bint.name AS year,date_part('year'::text, inv.created) as gregorian_year FROM c_order ord LEFT JOIN c_invoice inv ON ord.c_order_id = inv.c_order_id OR ord.c_order_id = inv.em_efin_c_order_id LEFT JOIN c_invoiceline ln ON inv.c_invoice_id = ln.c_invoice_id LEFT JOIN c_validcombination dime ON dime.c_validcombination_id = ln.em_efin_c_validcombination_id LEFT JOIN c_elementvalue elem ON elem.c_elementvalue_id = dime.account_id LEFT JOIN efin_budgetint bint ON inv.em_efin_budgetint_id = bint.efin_budgetint_id WHERE inv.docstatus = 'CO' AND date_part('month', inv.created) = 10::double precision GROUP BY ln.em_efin_c_elementvalue_id, ord.documentno, elem.value, bint.name, inv.created UNION ALL SELECT ord.documentno, elem.value, sum(ln.linenetamt * CASE WHEN inv.c_currency_id = '317' THEN 1 ELSE COALESCE((SELECT c_conversion_rate.multiplyrate FROM c_conversion_rate WHERE c_conversion_rate.c_currency_id = inv.c_currency_id), 1) END) AS actualamount, 11 AS month, bint.name AS year,date_part('year'::text, inv.created) as gregorian_year FROM c_order ord LEFT JOIN c_invoice inv ON ord.c_order_id = inv.c_order_id OR ord.c_order_id = inv.em_efin_c_order_id LEFT JOIN c_invoiceline ln ON inv.c_invoice_id = ln.c_invoice_id LEFT JOIN c_validcombination dime ON dime.c_validcombination_id = ln.em_efin_c_validcombination_id LEFT JOIN c_elementvalue elem ON elem.c_elementvalue_id = dime.account_id LEFT JOIN efin_budgetint bint ON inv.em_efin_budgetint_id = bint.efin_budgetint_id WHERE inv.docstatus = 'CO' AND date_part('month', inv.created) = 11::double precision GROUP BY ln.em_efin_c_elementvalue_id, ord.documentno, elem.value, bint.name,inv.created UNION ALL SELECT ord.documentno, elem.value, sum(ln.linenetamt * CASE WHEN inv.c_currency_id = '317' THEN 1 ELSE COALESCE((SELECT c_conversion_rate.multiplyrate FROM c_conversion_rate WHERE c_conversion_rate.c_currency_id = inv.c_currency_id), 1) END) AS actualamount, 12 AS month, bint.name AS year,date_part('year'::text, inv.created) as gregorian_year FROM c_order ord LEFT JOIN c_invoice inv ON ord.c_order_id = inv.c_order_id OR ord.c_order_id = inv.em_efin_c_order_id LEFT JOIN c_invoiceline ln ON inv.c_invoice_id = ln.c_invoice_id LEFT JOIN c_validcombination dime ON dime.c_validcombination_id = ln.em_efin_c_validcombination_id LEFT JOIN c_elementvalue elem ON elem.c_elementvalue_id = dime.account_id LEFT JOIN efin_budgetint bint ON inv.em_efin_budgetint_id = bint.efin_budgetint_id WHERE inv.docstatus = 'CO' AND date_part('month', inv.created) = 12::double precision GROUP BY ln.em_efin_c_elementvalue_id, ord.documentno, elem.value, bint.name, inv.created]]></view>
  </database>
