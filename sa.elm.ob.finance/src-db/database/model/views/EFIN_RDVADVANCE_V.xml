<?xml version="1.0"?>
  <database name="VIEW EFIN_RDVADVANCE_V">
    <view name="EFIN_RDVADVANCE_V"><![CDATA[SELECT get_uuid() AS efin_rdvadvance_v_id, hd.ad_client_id, hd.ad_org_id, hd.isactive, hd.created, hd.createdby, hd.updated, hd.updatedby, adv.trxln_no, adv.efin_rdv_id, COALESCE(adv.openamt, 0) AS openamt, COALESCE(adv.advamt, 0) AS advamt, sum(adv.openamt) OVER (PARTITION BY adv.efin_rdv_id ORDER BY adv.trxln_no) - sum(adv.advamt) OVER (PARTITION BY adv.efin_rdv_id ORDER BY adv.trxln_no) AS advrem, CASE WHEN adv.isadvance = 'N' THEN 'AA' WHEN adv.isadvance = 'Y' THEN 'A' ELSE NULL END AS advtype FROM (SELECT efin_rdvtxnline.trxln_no, sum(efin_rdvtxnline.advamt_rem) AS openamt, 0 AS advamt, efin_rdvtxnline.efin_rdv_id, efin_rdvtxnline.isadvance FROM efin_rdvtxnline WHERE efin_rdvtxnline.trxln_no = 0 GROUP BY efin_rdvtxnline.trxln_no, efin_rdvtxnline.efin_rdv_id, efin_rdvtxnline.isadvance UNION SELECT efin_rdvtxnline.trxln_no, 0 AS openamt, sum(efin_rdvtxnline.adv_deduct) AS sum, efin_rdvtxnline.efin_rdv_id, efin_rdvtxnline.isadvance FROM efin_rdvtxnline WHERE efin_rdvtxnline.trxln_no <> 0 GROUP BY efin_rdvtxnline.trxln_no, efin_rdvtxnline.efin_rdv_id, efin_rdvtxnline.isadvance ORDER BY 1) adv JOIN efin_rdv hd ON hd.efin_rdv_id = adv.efin_rdv_id]]></view>
  </database>
