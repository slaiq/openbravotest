OB.CheckAvailableCredit={};OB.CheckAvailableCredit.onLoad=function(a){var e,c=a.theForm,d=a.parentWindow.view.getContextInfo().C_BPartner_ID,b=c.getItem("C_Currency_ID").getValue();e=function(f,h,g){if(h.availableCredit){a.messageBar.setMessage(isc.OBMessageBar.TYPE_WARNING,null,OB.I18N.getLabel("BPCurrencyChange"));
c.getItem("c_glitem_id").visible=true;c.getItem("c_glitem_id").setRequired(true);if(c.getItem("c_glitem_id").textBoxStyle.indexOf("Required")==-1){c.getItem("c_glitem_id").textBoxStyle+="Required";}}else{c.getItem("c_glitem_id").visible=false;}c.redraw();if(a){a.handleButtonsStatus();}};OB.RemoteCallManager.call("org.openbravo.common.actionhandler.CheckAvailableCreditActionHandler",{businessPartnerId:d,currencyId:b},{},e);
};OB.CheckAvailableCredit.onProcess=function(h,i,j){var c=h.theForm,g=h.parentWindow.view.getContextInfo().inpbpCurrencyId,b=c.getItem("C_Currency_ID").getValue(),a=c.getItem("c_glitem_id").getValue(),e=c.getItem("Amount").getValue(),f=h.parentWindow.view.getContextInfo().inpsoCreditused,d=c.getItem("Foreign_Amount").getValue();
if(g!==b&&a&&e===true&&f===0&&d!==0){h.messageBar.setMessage(isc.OBMessageBar.TYPE_ERROR,null,OB.I18N.getLabel("BPCurrencyChangeRate"));return j();}else{i();}};