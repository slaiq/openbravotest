isc.defineClass("PeriodControlStatus_Field",isc.Label);isc.PeriodControlStatus_Field.addProperties({height:1,width:100,initWidget:function(){if(this.record&&this.record.periodStatus){this.createField(this.record.periodStatus);}this.Super("initWidget",arguments);},createField:function(a){var b="#C0C0C0",c,d="center";
if(a==="O"){b="#00FF00";c="";}else{if(a==="C"){b="#FF0000";c="";}else{if(a==="P"){b="#FF0000";c="";}else{if(a==="N"){b="#C2C2A3";c="";}else{c="periodControlStatus not supported";}}}}this.setBackgroundColor(b);this.setAlign(d);}});isc.defineClass("PeriodStatus_Field",isc.Label);isc.PeriodStatus_Field.addProperties({height:1,width:100,initWidget:function(){if(this.record&&this.record.status){this.createField(this.record.status);
}this.Super("initWidget",arguments);},createField:function(a){var b="#C0C0C0",c,d="center";if(a==="O"){b="#00FF00";c="";}else{if(a==="C"){b="#FF0000";c="";}else{if(a==="P"){b="#FF0000";c="";}else{if(a==="M"){b="#FFA319";c="";}else{if(a==="N"){b="#C2C2A3";c="";}else{c="periodStatus not supported";}}}}}this.setBackgroundColor(b);
this.setAlign(d);}});OB=OB||{};OB.OpenClose={execute:function(b,f){var d,g=b.button.contextView.viewGrid.getSelectedRecords(),e=[],c=f.getView(b.adTabId).messageBar,j,h,a=true;j=function(n,m,l){var k=n.status,i=l.clientContext.view.getView(b.adTabId);i.messageBar.setMessage(m.message.severity,null,m.message.text);
b.button.closeProcessPopup();};for(d=0;d<g.length;d++){e.push(g[d].id);}isc.OpenClosePeriodProcessPopup.create({recordIdList:e,view:f,params:b}).show();},openClose:function(b,a){b.actionHandler="org.openbravo.client.application.event.OpenClosePeriodHandler";b.adTabId=a.activeView.tabId;b.processId="A832A5DA28FB4BB391BDE883E928DFC5";
OB.OpenClose.execute(b,a);}};isc.defineClass("OpenClosePeriodProcessPopup",isc.OBPopup);isc.OpenClosePeriodProcessPopup.addProperties({width:320,height:200,title:null,showMinimizeButton:false,showMaximizeButton:false,mainform:null,okButton:null,cancelButton:null,getActionList:function(b){var c={recordIdList:this.recordIdList},d,a=this;
c.action="ACTION_COMBO";OB.RemoteCallManager.call("org.openbravo.client.application.event.OpenClosePeriodHandler",c,{},function(e,g,f){if(e){d=b.getField("Action");if(e.data){a.setTitle("Process Request");d.closePeriodStepId=e.data.nextStepId;d.setValueMap(e.data.actionComboBox.valueMap);d.setDefaultValue(e.data.actionComboBox.defaultValue);
}}});},initWidget:function(){OB.TestRegistry.register("org.openbravo.client.application.OpenClosePeriod.popup",this);var c=this.recordIdList,a=this.view,b=this.params;this.mainform=isc.DynamicForm.create({numCols:2,colWidths:["50%","50%"],fields:[{name:"Action",title:OB.I18N.getLabel("Action"),height:20,width:255,required:true,type:"_id_17",closePeriodStepId:null,defaultToFirstOption:true}]});
this.okButton=isc.OBFormButton.create({title:OB.I18N.getLabel("OK"),popup:this,action:function(){var e,d;e=function(j,i,h){var g=j.status,f=h.clientContext.originalView.getView(b.adTabId);if(i.message){f.messageBar.setMessage(i.message.severity,null,i.message.text);}h.clientContext.popup.closeClick();
h.clientContext.originalView.refresh(false,false);};d=this.popup.mainform.getItem("Action").getValue();OB.RemoteCallManager.call(b.actionHandler,{closePeriodStepId:this.popup.mainform.getItem("Action").closePeriodStepId,recordIdList:c,action:d},{},e,{originalView:this.popup.view,popup:this.popup});}});
OB.TestRegistry.register("org.openbravo.client.application.OpenClosePeriod.popup.okButton",this.okButton);this.cancelButton=isc.OBFormButton.create({title:OB.I18N.getLabel("Cancel"),popup:this,action:function(){this.popup.closeClick();}});this.getActionList(this.mainform);this.items=[isc.VLayout.create({defaultLayoutAlign:"center",align:"center",width:"100%",layoutMargin:10,membersMargin:6,members:[isc.HLayout.create({defaultLayoutAlign:"center",align:"center",layoutMargin:30,membersMargin:6,members:this.mainform}),isc.HLayout.create({defaultLayoutAlign:"center",align:"center",membersMargin:10,members:[this.okButton,this.cancelButton]})]})];
this.Super("initWidget",arguments);}});